{
 "name": "Outbound Shipping Status Report",
 "docstatus": 0,
 "report_name": "Outbound Shipping Status Report",
 "ref_doctype": "Delivery Note",
 "reference_report": null,
 "is_standard": "Yes",
 "module": "Stock",
 "report_type": "Query Report",
 "letter_head": "SurgiShop",
 "add_total_row": 0,
 "disabled": 0,
 "prepared_report": 0,
 "add_translate_data": 0,
 "timeout": 0,
 "query": "WITH base_data AS (\r\n    SELECT\r\n        dn.name AS delivery_note,\r\n        dn.customer,\r\n        dn.shipping_rule,\r\n        dn.custom_custom_shipping AS billing,\r\n        dn.custom_customer_freight_acct,\r\n        COALESCE(so_rep.sales_person, '') AS sales_rep,\r\n        dn.custom_order_product_attributes AS notes,\r\n        dn.docstatus,\r\n        dn.posting_date,\r\n        ROW_NUMBER() OVER (\r\n            ORDER BY dn.posting_date DESC, dn.name DESC\r\n        ) AS row_num\r\n    FROM\r\n        `tabDelivery Note` dn\r\n\r\n    LEFT JOIN (\r\n        SELECT\r\n            so.name AS sales_order,\r\n            GROUP_CONCAT(DISTINCT st.sales_person SEPARATOR ', ') AS sales_person\r\n        FROM `tabSales Order` so\r\n        INNER JOIN `tabSales Team` st ON st.parent = so.name\r\n        GROUP BY so.name\r\n    ) so_rep\r\n        ON so_rep.sales_order = (\r\n            SELECT dni.against_sales_order\r\n            FROM `tabDelivery Note Item` dni\r\n            WHERE dni.parent = dn.name\r\n            LIMIT 1\r\n        )\r\n\r\n    WHERE\r\n        (%(from_date)s = '' OR %(from_date)s IS NULL OR dn.posting_date >= %(from_date)s)\r\n        AND (%(to_date)s = '' OR %(to_date)s IS NULL OR dn.posting_date <= %(to_date)s)\r\n)\r\n\r\nSELECT\r\n    -- Delivery Note (clickable, prefix removed)\r\n    CONCAT(\r\n        '<div style=\"text-align:left;background-color:',\r\n        CASE WHEN MOD(row_num,2)=0 THEN '#f2f2f2' ELSE 'white' END,\r\n        ';\">',\r\n        '<a href=\"/app/delivery-note/', delivery_note, '\">',\r\n        REPLACE(delivery_note, 'MAT-DN-', ''),\r\n        '</a></div>'\r\n    ) AS delivery_note,\r\n\r\n    -- Customer\r\n    CONCAT(\r\n        '<div style=\"text-align:left;background-color:',\r\n        CASE WHEN MOD(row_num,2)=0 THEN '#f2f2f2' ELSE 'white' END,\r\n        ';\">', customer, '</div>'\r\n    ) AS customer,\r\n\r\n    -- Shipping Speed\r\n    CONCAT(\r\n        '<div style=\"text-align:left;background-color:',\r\n        CASE WHEN MOD(row_num,2)=0 THEN '#f2f2f2' ELSE 'white' END,\r\n        ';\">', shipping_rule, '</div>'\r\n    ) AS speed,\r\n\r\n    -- Billing\r\n    CONCAT(\r\n        '<div style=\"text-align:left;background-color:',\r\n        CASE WHEN MOD(row_num,2)=0 THEN '#f2f2f2' ELSE 'white' END,\r\n        ';\">', billing, '</div>'\r\n    ) AS billing,\r\n\r\n    -- Freight Account\r\n    CONCAT(\r\n        '<div style=\"text-align:left;background-color:',\r\n        CASE WHEN MOD(row_num,2)=0 THEN '#f2f2f2' ELSE 'white' END,\r\n        ';\">', custom_customer_freight_acct, '</div>'\r\n    ) AS customer_freight_acct,\r\n\r\n    -- Sales Rep\r\n    CONCAT(\r\n        '<div style=\"text-align:left;background-color:',\r\n        CASE WHEN MOD(row_num,2)=0 THEN '#f2f2f2' ELSE 'white' END,\r\n        ';\">', sales_rep, '</div>'\r\n    ) AS sales_rep,\r\n\r\n    -- Notes\r\n    CONCAT(\r\n        '<div style=\"text-align:left;background-color:',\r\n        CASE WHEN MOD(row_num,2)=0 THEN '#f2f2f2' ELSE 'white' END,\r\n        ';\">', notes, '</div>'\r\n    ) AS notes,\r\n\r\n    -- Shipping Status Badge\r\n    CONCAT(\r\n        '<div style=\"background-color:',\r\n        CASE WHEN MOD(row_num,2)=0 THEN '#f2f2f2' ELSE 'white' END,\r\n        ';padding:2px;\">',\r\n        '<span style=\"display:inline-block;',\r\n        'padding:4px 10px;',\r\n        'border-radius:6px;',\r\n        'font-weight:bold;',\r\n        'color:',\r\n            CASE \r\n                WHEN docstatus = 0 THEN '#856404'\r\n                WHEN docstatus = 1 THEN '#155724'\r\n                ELSE '#721c24'\r\n            END,\r\n        ';background-color:',\r\n            CASE \r\n                WHEN docstatus = 0 THEN '#fff3cd'\r\n                WHEN docstatus = 1 THEN '#d4edda'\r\n                ELSE '#f8d7da'\r\n            END,\r\n        ';\">',\r\n            CASE \r\n                WHEN docstatus = 0 THEN 'Picking'\r\n                WHEN docstatus = 1 THEN 'Shipped'\r\n                ELSE 'Unknown'\r\n            END,\r\n        '</span></div>'\r\n    ) AS shipping_status\r\n\r\nFROM base_data\r\n\r\nORDER BY posting_date DESC, delivery_note DESC;\r\n",
 "report_script": "",
 "javascript": null,
 "json": null,
 "doctype": "Report",
 "filters": [
  {
   "name": "chqk38goo4",
   "owner": "gary.starr@surgishop.com",
   "creation": "2025-12-18 10:41:47.649989",
   "modified": "2025-12-18 11:13:59.809699",
   "modified_by": "gary.starr@surgishop.com",
   "docstatus": 0,
   "idx": 1,
   "label": "From Date",
   "fieldtype": "Date",
   "fieldname": "from_date",
   "mandatory": 0,
   "wildcard_filter": 0,
   "options": null,
   "default": "Today",
   "parent": "Outbound Shipping Status Report",
   "parentfield": "filters",
   "parenttype": "Report",
   "doctype": "Report Filter"
  },
  {
   "name": "chqkneov92",
   "owner": "gary.starr@surgishop.com",
   "creation": "2025-12-18 10:41:47.649989",
   "modified": "2025-12-18 11:13:59.809699",
   "modified_by": "gary.starr@surgishop.com",
   "docstatus": 0,
   "idx": 2,
   "label": "To Date",
   "fieldtype": "Date",
   "fieldname": "to_date",
   "mandatory": 0,
   "wildcard_filter": 0,
   "options": null,
   "default": "Today",
   "parent": "Outbound Shipping Status Report",
   "parentfield": "filters",
   "parenttype": "Report",
   "doctype": "Report Filter"
  }
 ],
 "roles": [
  {
   "name": "chqkfd5utn",
   "owner": "gary.starr@surgishop.com",
   "creation": "2025-12-18 10:41:47.649989",
   "modified": "2025-12-18 11:13:59.809699",
   "modified_by": "gary.starr@surgishop.com",
   "docstatus": 0,
   "idx": 1,
   "role": "Sales User",
   "parent": "Outbound Shipping Status Report",
   "parentfield": "roles",
   "parenttype": "Report",
   "doctype": "Has Role"
  },
  {
   "name": "chqkiipdvq",
   "owner": "gary.starr@surgishop.com",
   "creation": "2025-12-18 10:41:47.649989",
   "modified": "2025-12-18 11:13:59.809699",
   "modified_by": "gary.starr@surgishop.com",
   "docstatus": 0,
   "idx": 2,
   "role": "Accounts User",
   "parent": "Outbound Shipping Status Report",
   "parentfield": "roles",
   "parenttype": "Report",
   "doctype": "Has Role"
  },
  {
   "name": "chqkgrnh6o",
   "owner": "gary.starr@surgishop.com",
   "creation": "2025-12-18 10:41:47.649989",
   "modified": "2025-12-18 11:13:59.809699",
   "modified_by": "gary.starr@surgishop.com",
   "docstatus": 0,
   "idx": 3,
   "role": "Stock User",
   "parent": "Outbound Shipping Status Report",
   "parentfield": "roles",
   "parenttype": "Report",
   "doctype": "Has Role"
  },
  {
   "name": "chqkgflcf2",
   "owner": "gary.starr@surgishop.com",
   "creation": "2025-12-18 10:41:47.649989",
   "modified": "2025-12-18 11:13:59.809699",
   "modified_by": "gary.starr@surgishop.com",
   "docstatus": 0,
   "idx": 4,
   "role": "Delivery User",
   "parent": "Outbound Shipping Status Report",
   "parentfield": "roles",
   "parenttype": "Report",
   "doctype": "Has Role"
  },
  {
   "name": "chqkqsnes8",
   "owner": "gary.starr@surgishop.com",
   "creation": "2025-12-18 10:41:47.649989",
   "modified": "2025-12-18 11:13:59.809699",
   "modified_by": "gary.starr@surgishop.com",
   "docstatus": 0,
   "idx": 5,
   "role": "Delivery Manager",
   "parent": "Outbound Shipping Status Report",
   "parentfield": "roles",
   "parenttype": "Report",
   "doctype": "Has Role"
  },
  {
   "name": "chqkojn7pr",
   "owner": "gary.starr@surgishop.com",
   "creation": "2025-12-18 10:41:47.649989",
   "modified": "2025-12-18 11:13:59.809699",
   "modified_by": "gary.starr@surgishop.com",
   "docstatus": 0,
   "idx": 6,
   "role": "Stock Manager",
   "parent": "Outbound Shipping Status Report",
   "parentfield": "roles",
   "parenttype": "Report",
   "doctype": "Has Role"
  }
 ],
 "columns": [
  {
   "name": "chqk8j15o8",
   "owner": "gary.starr@surgishop.com",
   "creation": "2025-12-18 10:41:47.649989",
   "modified": "2025-12-18 11:13:59.809699",
   "modified_by": "gary.starr@surgishop.com",
   "docstatus": 0,
   "idx": 1,
   "fieldname": "delivery_note",
   "label": "Delivery Note",
   "fieldtype": "Data",
   "options": "",
   "width": 150,
   "parent": "Outbound Shipping Status Report",
   "parentfield": "columns",
   "parenttype": "Report",
   "doctype": "Report Column"
  },
  {
   "name": "chqkbt8i3q",
   "owner": "gary.starr@surgishop.com",
   "creation": "2025-12-18 10:41:47.649989",
   "modified": "2025-12-18 11:13:59.809699",
   "modified_by": "gary.starr@surgishop.com",
   "docstatus": 0,
   "idx": 2,
   "fieldname": "customer",
   "label": "Customer",
   "fieldtype": "Data",
   "options": "",
   "width": 180,
   "parent": "Outbound Shipping Status Report",
   "parentfield": "columns",
   "parenttype": "Report",
   "doctype": "Report Column"
  },
  {
   "name": "chqkfrta4h",
   "owner": "gary.starr@surgishop.com",
   "creation": "2025-12-18 10:41:47.649989",
   "modified": "2025-12-18 11:13:59.809699",
   "modified_by": "gary.starr@surgishop.com",
   "docstatus": 0,
   "idx": 3,
   "fieldname": "shipping_rule",
   "label": "Speed",
   "fieldtype": "Data",
   "options": null,
   "width": 120,
   "parent": "Outbound Shipping Status Report",
   "parentfield": "columns",
   "parenttype": "Report",
   "doctype": "Report Column"
  },
  {
   "name": "chqko26om5",
   "owner": "gary.starr@surgishop.com",
   "creation": "2025-12-18 10:41:47.649989",
   "modified": "2025-12-18 11:13:59.809699",
   "modified_by": "gary.starr@surgishop.com",
   "docstatus": 0,
   "idx": 4,
   "fieldname": "custom_custom_shipping",
   "label": "Billing",
   "fieldtype": "Data",
   "options": null,
   "width": 120,
   "parent": "Outbound Shipping Status Report",
   "parentfield": "columns",
   "parenttype": "Report",
   "doctype": "Report Column"
  },
  {
   "name": "chqkps39k0",
   "owner": "gary.starr@surgishop.com",
   "creation": "2025-12-18 10:41:47.649989",
   "modified": "2025-12-18 11:13:59.809699",
   "modified_by": "gary.starr@surgishop.com",
   "docstatus": 0,
   "idx": 5,
   "fieldname": "custom_customer_freight_acct",
   "label": "Customer Freight Acct",
   "fieldtype": "Data",
   "options": null,
   "width": 175,
   "parent": "Outbound Shipping Status Report",
   "parentfield": "columns",
   "parenttype": "Report",
   "doctype": "Report Column"
  },
  {
   "name": "fjn2tkikab",
   "owner": "gary.starr@surgishop.com",
   "creation": "2025-12-18 10:41:47.649989",
   "modified": "2025-12-18 11:13:59.809699",
   "modified_by": "gary.starr@surgishop.com",
   "docstatus": 0,
   "idx": 6,
   "fieldname": "sales_rep",
   "label": "Sales Rep",
   "fieldtype": "Data",
   "options": null,
   "width": 150,
   "parent": "Outbound Shipping Status Report",
   "parentfield": "columns",
   "parenttype": "Report",
   "doctype": "Report Column"
  },
  {
   "name": "chqkqrjov6",
   "owner": "gary.starr@surgishop.com",
   "creation": "2025-12-18 10:41:47.649989",
   "modified": "2025-12-18 11:13:59.809699",
   "modified_by": "gary.starr@surgishop.com",
   "docstatus": 0,
   "idx": 7,
   "fieldname": "custom_order_product_attributes",
   "label": "Notes",
   "fieldtype": "Data",
   "options": null,
   "width": 200,
   "parent": "Outbound Shipping Status Report",
   "parentfield": "columns",
   "parenttype": "Report",
   "doctype": "Report Column"
  },
  {
   "name": "chqkl3q545",
   "owner": "gary.starr@surgishop.com",
   "creation": "2025-12-18 10:41:47.649989",
   "modified": "2025-12-18 11:13:59.809699",
   "modified_by": "gary.starr@surgishop.com",
   "docstatus": 0,
   "idx": 8,
   "fieldname": "shipping_status",
   "label": "Shipping Status",
   "fieldtype": "Data",
   "options": null,
   "width": 100,
   "parent": "Outbound Shipping Status Report",
   "parentfield": "columns",
   "parenttype": "Report",
   "doctype": "Report Column"
  }
 ]
}